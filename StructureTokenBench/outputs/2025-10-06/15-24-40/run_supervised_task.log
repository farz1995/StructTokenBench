[2025-10-06 15:24:40,411][util][INFO] - Configuration args
[2025-10-06 15:24:40,411][util][INFO] - {'model': {'class_name': 'SequenceClassificationModel', 'pretrained_ckpt_path': '', 'ckpt_path': None, 'num_labels': 45, 'dropout': 0.1, 'num_layer': 1, 'hidden_size': 512, 'num_tokens': None, 'd_model': 256, 'is_global_or_local': 'global', 'multi_label': False, 'regression': False, 'use_sequence': False, 'sequence_only': False, 'add_noise': None}, 'deepspeed_path': 'src/script/config/deepspeed/32_stage2.json', 'default_data_dir': '/home/fe5vb/project/PST/struct_token_bench_release_data', 'tokenizer': 'WrappedMyRepTokenizer', 'tokenizer_pretrained_ckpt_path': None, 'tokenizer_ckpt_name': None, 'max_steps': 10000, 'experiment_name': 'homo_myrep', 'run_name': 'debug_skip_empty', 'validate_only': False, 'test_only': False, 'save_dir_path': '', 'tokenizer_device': 'cuda', 'precompute_tokens': True, 'quantizer_use_linear_project': False, 'model_encoder_dmodel': 1024, 'model_encoder_nlayers': 2, 'model_encoder_vheads': 128, 'quantizer_codebook_size': 4096, 'quantizer_codebook_embed_size': 128, 'model_encoder_dout': 128, 'trainer': {'accelerator': 'gpu', 'num_nodes': 1, 'check_val_every_n_epoch': 1, 'default_root_dir': '/home/fe5vb/project/PST/struct_token_bench_logs', 'enable_checkpointing': True, 'enable_model_summary': True, 'enable_progress_bar': True, 'devices': [0], 'gradient_clip_val': 1.0, 'limit_train_batches': 1, 'limit_val_batches': None, 'log_every_n_steps': 20, 'max_epochs': None, 'max_steps': 1, 'num_sanity_val_steps': 0, 'precision': '32-true', 'reload_dataloaders_every_n_epochs': 1, 'val_check_interval': 1.0, 'accumulate_grad_batches': 1, 'deterministic': True}, 'lightning': {'model_module': {'_target_': 'model_module.PlModel', 'py_logger': None, 'optimizer_cfg': None, 'model_cfg': None}, 'data_module': {'_target_': 'data_module.ProteinDataModule'}, 'callbacks': {'checkpoint': {'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'every_n_train_steps': None, 'every_n_epochs': 1, 'save_top_k': 3, 'monitor': 'validation_f1_score', 'mode': 'max', 'filename': '{epoch}-{step}-{validation_f1_score:.2f}', 'save_last': True, 'dirpath': None}, 'lr_monitor': {'_target_': 'pytorch_lightning.callbacks.LearningRateMonitor', 'logging_interval': 'step'}, 'progress_bar': {'_target_': 'pytorch_lightning.callbacks.progress.TQDMProgressBar', 'refresh_rate': 10}}, 'logger': {'_target_': 'pytorch_lightning.loggers.TensorBoardLogger', 'save_dir': '/home/fe5vb/project/PST/struct_token_bench_logs', 'name': 'homo_myrep'}, 'strategy': {'_target_': 'pytorch_lightning.strategies.DeepSpeedStrategy', 'config': 'src/script/config/deepspeed/32_stage2.json', 'remote_device': None}}, 'data': {'num_workers': 0, 'prefetch_factor': None, 'data_path': '/home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/', 'data_name': 'TapeRemoteHomologyDataset', 'target_field': 'fold_label', 'filter_length': 600, 'truncation_length': 5000, 'multi_label': False, 'is_global_or_local': 'global', 'pdb_data_dir': '/home/fe5vb/project/PST/pdb_data/mmcif_files', 'fast_dev_run': False, 'use_continuous': False, 'use_sequence': False}, 'optimization': {'micro_batch_size': 8, 'seed': 1234, 'optimizer': {'name': 'adam', 'lr': 0.0002, 'betas': [0.9, 0.98], 'eps': 1e-08, 'adam_w_mode': True, 'weight_decay': 0.01, 'params': None}, 'scheduler': {'_target_': 'util.get_cosine_schedule_with_warmup', 'optimizer': None, 'min_ratio': 0.1, 'plateau_ratio': 0.1, 'num_warmup_steps': 200, 'num_training_steps': 10000}, 'override': {'mult_factor': 1.0, 'add_index': 0}}, 'autorestart': {'filter_keywords': ['last.ckpt']}}
[2025-10-06 15:24:40,412][root][INFO] - Training with 1 nodes micro-batch size 8 total batch size 8 and 1 devices per-node
[2025-10-06 15:24:40,423][util][INFO] - [run] Continuous tokenizer detected (H5 features).
[2025-10-06 15:24:40,427][util][INFO] - *********** start training ***********

[2025-10-06 15:24:47,733][util][INFO] - Loading from processed file /home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/remote_homology/processed_structured_train,structured data of 12114 entries.
[2025-10-06 15:24:47,792][util][INFO] - reduce sequence lengths because of ProTokens from 12071 to 12071
[2025-10-06 15:24:47,793][util][INFO] - reduce sequence lengths for TAPE Homo to 12069
[2025-10-06 15:24:47,814][util][INFO] - [45-class] split=train: kept 6003, dropped 6066
[2025-10-06 15:24:47,820][util][INFO] - Loading shard 0 with world size 1
[2025-10-06 15:24:47,829][util][INFO] - Done sharded loading.
[2025-10-06 15:24:47,832][util][INFO] - Finished loading training data: 6003 samples
[2025-10-06 15:24:48,193][util][INFO] - Loading from processed file /home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/remote_homology/processed_structured_valid,structured data of 729 entries.
[2025-10-06 15:24:48,199][util][INFO] - reduce sequence lengths because of ProTokens from 723 to 723
[2025-10-06 15:24:48,201][util][INFO] - [45-class] split=validation: kept 241, dropped 482
[2025-10-06 15:24:48,204][util][INFO] - Loading shard 0 with world size 1
[2025-10-06 15:24:48,205][util][INFO] - Done sharded loading.
[2025-10-06 15:24:48,206][util][INFO] - Finished loading validation data: 241 samples
[2025-10-06 15:24:48,544][util][INFO] - Loading from processed file /home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/remote_homology/processed_structured_test_fold_holdout,structured data of 710 entries.
[2025-10-06 15:24:48,548][util][INFO] - reduce sequence lengths because of ProTokens from 708 to 708
[2025-10-06 15:24:48,549][util][INFO] - [45-class] split=test_fold_holdout: kept 232, dropped 476
[2025-10-06 15:24:48,551][util][INFO] - Loading shard 0 with world size 1
[2025-10-06 15:24:48,553][util][INFO] - Done sharded loading.
[2025-10-06 15:24:48,554][util][INFO] - Finished loading test_fold_holdout data: 232 samples
[2025-10-06 15:24:49,136][util][INFO] - Loading from processed file /home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/remote_homology/processed_structured_test_family_holdout,structured data of 1247 entries.
[2025-10-06 15:24:49,143][util][INFO] - reduce sequence lengths because of ProTokens from 1242 to 1242
[2025-10-06 15:24:49,145][util][INFO] - [45-class] split=test_family_holdout: kept 788, dropped 454
[2025-10-06 15:24:49,147][util][INFO] - Loading shard 0 with world size 1
[2025-10-06 15:24:49,148][util][INFO] - Done sharded loading.
[2025-10-06 15:24:49,149][util][INFO] - Finished loading test_family_holdout data: 788 samples
[2025-10-06 15:24:49,757][util][INFO] - Loading from processed file /home/fe5vb/project/PST/struct_token_bench_release_data/data/structural/remote_homology/processed_structured_test_superfamily_holdout,structured data of 1234 entries.
[2025-10-06 15:24:49,763][util][INFO] - reduce sequence lengths because of ProTokens from 1229 to 1229
[2025-10-06 15:24:49,766][util][INFO] - [45-class] split=test_superfamily_holdout: kept 455, dropped 774
[2025-10-06 15:24:49,770][util][INFO] - Loading shard 0 with world size 1
[2025-10-06 15:24:49,772][util][INFO] - Done sharded loading.
[2025-10-06 15:24:49,773][util][INFO] - Finished loading test_superfamily_holdout data: 455 samples
